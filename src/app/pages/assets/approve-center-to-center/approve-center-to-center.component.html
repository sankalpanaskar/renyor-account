<form #fm="ngForm" (ngSubmit)="onSubmit(fm)" novalidate id="leadFormBulk" style="width: 100%;
max-width: 900px;margin: 0 auto;">
    <div class="row">
        <div class="col-lg-12">
            <nb-card>
                <nb-card-header>Approve Center To Center</nb-card-header>
                <nb-card-body [nbSpinner]="isSubmitting" nbSpinnerStatus="primary">

                    <div class="row">

                        <div class="col-lg-12">
                            <label class="small-label" id="label-category">Center<span
                                    style="color:#d32f2f">*</span></label>
                            <nb-select shape="semi-round" placeholder="Select Center" name="from_center"
                                (selectedChange)="selectFromCenter($event)" required #from_center="ngModel"
                                [(ngModel)]="model.from_center">
                                <nb-option *ngFor="let data of centerList"
                                    [value]="data.center_code">{{data.center_code}}</nb-option>
                            </nb-select>
                            <div *ngIf="fm.submitted && from_center.invalid" class="error-message">Center is required
                            </div>
                        </div>

                    </div>
                    <!-- Show only when center is selected -->
                    <div *ngIf="showAssetList">

                        <!-- ðŸ”¹ Asset Table Section -->
                        <div class="row mt-3" style="margin: 0px 4px 0px 4px;">
                            <div class="col-lg-12" style="border: 1px solid #dee2e6; padding: 0px; border-radius: 6px;">
                                <!-- Search Input -->
                                <div class="p-2 border-bottom" style="background-color: #f7f9fc;">
                                    <input style="height: 30%;" status="primary" nbInput fullWidth
                                        placeholder="Search Asset..." [(ngModel)]="searchTextStudent"
                                        (ngModelChange)="filterAsset()" />
                                </div>

                                <div style="max-height: 300px; overflow-y: auto;">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th style="width: 15%;">
                                                    <input type="checkbox" class="custom-checkbox"
                                                        [(ngModel)]="masterSelected" (change)="selectAll()"
                                                        [ngModelOptions]="{standalone: true}">
                                                    Select ({{ selectedCount }})
                                                </th>
                                                <th style="width: 10%;">Brand </th>
                                                <th style="width: 15%;">Item</th>
                                                <th style="width: 15%;">Serial No</th>
                                                <th style="width: 12%;">From Center</th>
                                                <th style="width: 12%;">To Center</th>
                                                <th style="width: 32%;">Anudip ID</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let asset of filteredAssetList; let i = index">
                                                <td style="width: 15%;">
                                                    <input type="checkbox" class="custom-checkbox-td"
                                                        [(ngModel)]="asset.isSelected" (change)="checkIfAllSelected()"
                                                        name="leadSelect{{i}}" [ngModelOptions]="{standalone: true}">
                                                </td>
                                                <td style="width: 10%;">{{ asset.brand_name }}</td>
                                                <td style="width: 15%;">{{ asset.assets_sub_class }}</td>
                                                <td style="width: 15%;">{{ asset.serial_no }}</td>
                                                <td style="width: 12%;">{{ asset.from_center }}</td>
                                                <td style="width: 12%;">{{ asset.to_center }}</td>
                                                <td style="width: 32%;">{{ asset.anudip_identification_no }}</td>
                                            </tr>

                                            <tr *ngIf="assetList.length === 0">
                                                <td colspan="7" class="text-center text-muted">
                                                    No Asset Found
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- ðŸ”¹ Approval Status (Radio Buttons) -->
                        <div class="row mt-3">
                            <div class="col-lg-12">
                                <label class="small-label" id="label-category">Approval Status
                                    <span style="color:#d32f2f">*</span>
                                </label>

                                <nb-radio-group [(ngModel)]="model.approval_status" name="approval_status"
                                    class="d-flex flex-row" #approval_status="ngModel" required>
                                    <nb-radio value="Accept">Accept</nb-radio>
                                    <nb-radio value="Reject">Reject</nb-radio>
                                    <nb-radio value="Revoke">Revoke</nb-radio>
                                </nb-radio-group>

                                <div *ngIf="fm.submitted && approval_status.invalid" class="error-message">
                                    Please select an approval status
                                </div>
                            </div>
                        </div>

                        <!-- ðŸ”¹ Remarks Section -->
                        <div class="row">
                            <div class="col-lg-12">
                                <label class="small-label" id="label-category">
                                    Remarks <span style="color:#d32f2f">*</span>
                                </label>
                                <textarea nbInput fullWidth placeholder="Add remarks" name="remarks"
                                    [(ngModel)]="model.remarks" #remarks="ngModel" rows="2"
                                    [maxlength]="500"></textarea>

                                <div style="font-size: 12px; color:#6c757d; margin-top: 4px;">
                                    {{ (model.remarks?.length || 0) }}/500
                                </div>

                                <div *ngIf="fm.submitted && remarks.invalid" class="error-message">
                                    Remarks are required
                                </div>
                            </div>
                        </div>

                        <button nbButton status="primary" shape="semi-round" hero type="submit"
                            [disabled]="isSubmitting">
                            Save
                        </button>
                    </div>


                </nb-card-body>
            </nb-card>
        </div>
    </div>
</form>