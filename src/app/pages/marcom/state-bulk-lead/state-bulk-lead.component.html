<form #fm="ngForm" (ngSubmit)="onSubmit(fm)" novalidate id="leadFormBulk" style="width: 80%;
max-width: 900px;margin: 0 auto;">
  <div class="row">
    <div class="col-lg-12">
      <nb-card>
        <nb-card-header>Statewise Upload Lead</nb-card-header>
        <nb-card-body [nbSpinner]="isSubmitting" nbSpinnerStatus="primary">

          <div class="row">

            <div class="col-lg-6">
              <nb-select shape="semi-round" placeholder="Source Category" name="category" required #category="ngModel"
                [(ngModel)]="model.category" (selectedChange)="onCategoryChange($event)">
                <nb-option *ngFor="let category of categoryList" [value]="category.category_name">
                  {{ category.category_name }}
                </nb-option>
              </nb-select>
              <div *ngIf="fm.submitted && category.invalid" class="error-message">Source type is required</div>
            </div>

            <div class="col-lg-6">
              <nb-select shape="semi-round" placeholder="Source Type" name="source_type" required #source_type="ngModel"
                [(ngModel)]="model.source_type" (selectedChange)="onSourceChange($event)">
                <nb-option *ngFor="let source of filteredSourceList" [value]="source">
                  {{ source.source_type }}
                </nb-option>

              </nb-select>
              <div *ngIf="fm.submitted && source_type.invalid" class="error-message">Source type is required</div>
            </div>

          </div>

          <div class="row">

            <div class="col-lg-6">
              <input type="text" nbInput fullWidth shape="semi-round" placeholder="Source Name" name="source_name"
                required #source_name="ngModel" [(ngModel)]="model.source_name">
              <div *ngIf="fm.submitted && source_name.invalid" class="error-message">Source name is required</div>
            </div>

            <div class="col-lg-6">
              <nb-select shape="semi-round" placeholder="Select Center" name="center" required #center="ngModel"
                [(ngModel)]="model.center" (selectedChange)="centerSelect($event)">
                <nb-option *ngFor="let center of centerList"
                  [value]="center.center_id">{{center.short_code}}</nb-option>
              </nb-select>
              <div *ngIf="fm.submitted && center.invalid" class="error-message">Center is required</div>
            </div>


          </div>

          <div class="row">

            <div class="col-lg-6">
              <nb-select shape="semi-round" placeholder="Select Course" name="course" required #course="ngModel"
                [(ngModel)]="model.course" (selectedChange)="courseSelect($event)">
                <nb-option *ngFor="let course of courseList"
                  [value]="course.id">{{course.alias}}-{{course.name}}</nb-option> </nb-select>
              <div *ngIf="fm.submitted && course.invalid" class="error-message">Course is required</div>
            </div>

            <div class="col-lg-6">
              <input type="file" nbInput fullWidth shape="semi-round" name="file" required #file="ngModel"
                [(ngModel)]="model.file" (change)="onFileChange($event)" accept=".xls,.xlsx" />
              <div *ngIf="fileError" class="error-message">{{ fileError }}</div>
              <div *ngIf="fm.submitted && file.invalid" class="error-message">File is required</div>

              <!-- ℹ️ Hint and download link -->
              <small class="text-muted d-block mt-1">
                Upload only Excel files (.xls, .xlsx).
                <a [href]="excelPath" download class="ml-2">Download demo Excel file</a>
              </small>
            </div>
          </div>

          <button nbButton status="primary" shape="semi-round" hero type="submit" [disabled]="isSubmitting">
            Save
          </button>

        </nb-card-body>
      </nb-card>
    </div>
  </div>
</form>