<nb-card>
    <nb-card-header>Generate Report</nb-card-header>
    <nb-card-body [nbSpinner]="isSubmitting" nbSpinnerStatus="primary">
        <nb-accordion multi>
            <!-- Module Completion Report with Form -->
            <nb-accordion-item>
                <nb-accordion-item-header>
                    <nb-icon icon="alert-circle-outline" status="primary" class="mr-2"></nb-icon>
                    Lead CRM Report
                </nb-accordion-item-header>

                <nb-accordion-item-body>
                    <form #fm="ngForm" (ngSubmit)="onSubmit(fm)" novalidate>
                        <!-- âœ… Hidden input inside the form -->
                        <input type="hidden" name="report_type" ngModel="lead_crm_report" #report_type="ngModel">

                        <div class="date-range">
                            <!-- Start Date -->
                            <div class="form-field">
                                <input nbInput placeholder="From Date *" [nbDatepicker]="startPicker" name="startDate"
                                    [(ngModel)]="startDate" required #startDateInput="ngModel" />
                                <nb-datepicker #startPicker></nb-datepicker>
                                <div *ngIf="fm.submitted && startDateInput.invalid" class="error-text">
                                    Start Date is required.
                                </div>
                            </div>

                            <!-- End Date -->
                            <div class="form-field">
                                <input nbInput placeholder="To Date *" [nbDatepicker]="endPicker" name="endDate"
                                    [(ngModel)]="endDate" required #endDateInput="ngModel" />
                                <nb-datepicker [max]="today" #endPicker></nb-datepicker>
                                <div *ngIf="fm.submitted && endDateInput.invalid" class="error-text">
                                    End Date is required.
                                </div>
                            </div>
                        </div>

                        <div style="text-align: right; margin-top: 1rem;margin-right: 60px;">
                            <button nbButton status="success" type="submit" [disabled]="isSubmitting">
                                Download Report
                            </button>
                        </div>

                    </form>
                </nb-accordion-item-body>
            </nb-accordion-item>

        </nb-accordion>
    </nb-card-body>
</nb-card>